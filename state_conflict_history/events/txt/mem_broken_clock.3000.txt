namespace = mem_broken_clock
country_event = {
    id = mem_broken_clock.3000
    hide_window = yes
    is_triggered_only = yes
    immediate = {
        random_list = {
            175 = {
                country_event = {
                    id = mem_broken_clock.3000
                    days = 360
                }
                modifier = {
                    factor = 5
                    NOT = {
                        any_system_within_border = {
                            has_star_flag = mem_broken_clock_system
                        }
                    }
                }
                modifier = {
                    factor = 0
                    has_global_flag = mem_broken_clock_kill_now
                }
            }
            25 = {
                every_system_within_border = {
                    set_star_flag = mem_broken_clock_unwelcome_guests_purged
                }
                mem_broken_clock_kill_invaders = yes
                every_country = {
                    limit = {
                        has_established_contact = root
                    }
                    country_event = {
                        id = mem_broken_clock.3001
                    }
                }
                random_system_within_border = {
                    limit = {
                        has_star_flag = mem_broken_clock_system
                    }
                    set_global_flag = mem_broken_clock_system_reverted
                    save_event_target_as = broken_clock_system
                    star = {
                        change_pc = pc_neutron_star
                    }
                    every_system_planet = {
                        limit = {
                            is_planet_class = pc_habitat
                        }
                        remove_planet = yes
                    }
                    every_system_planet = {
                        limit = {
                            has_planet_flag = mem_broken_clock_mining_moon
                        }
                        change_pc = pc_shrouded
                        clear_deposits = yes
                        random_mining_station = {
                            dismantle = yes
                        }
                    }
                    random_system_planet = {
                        limit = {
                            has_planet_flag = mem_broken_clock_toxic_moon
                        }
                        change_pc = pc_shrouded
                        clear_deposits = yes
                        random_mining_station = {
                            dismantle = yes
                        }
                    }
                    random_system_planet = {
                        limit = {
                            has_planet_flag = mem_broken_clock_frozen_moon
                        }
                        change_pc = pc_shrouded
                        clear_deposits = yes
                        random_mining_station = {
                            dismantle = yes
                        }
                    }
                    every_system_planet = {
                        limit = {
                            is_planet_class = pc_ringworld_habitable
                        }
                        destroy_colony = yes
                        change_pc = pc_ringworld_habitable_damaged
                    }
                    every_system_planet = {
                        limit = {
                            is_planet_class = pc_ringworld_tech
                        }
                        destroy_colony = yes
                        change_pc = pc_ringworld_tech_damaged
                        reroll_planet = yes
                    }
                    every_system_planet = {
                        limit = {
                            is_planet_class = pc_ringworld_seam
                        }
                        destroy_colony = yes
                        change_pc = pc_ringworld_seam_damaged
                        reroll_planet = yes
                    }
                    every_system_planet = {
                        limit = {
                            has_planet_flag = mem_broken_clock_homeworld
                        }
                        destroy_colony = yes
                        change_pc = pc_shrouded
                    }
                }
                every_country = {
                    limit = {
                        has_country_flag = mem_broken_clock_breakaways
                    }
                    every_country = {
                        limit = {
                            OR = {
                                has_country_flag = mem_broken_clock_breakaways
                                has_communications = root
                            }
                            NOT = {
                                is_same_value = prev
                            }
                        }
                        establish_communications_no_message = prev
                        add_opinion_modifier = {
                            modifier = mem_broken_clock_fellow_rebels
                            who = prev
                        }
                    }
                }
                destroy_country = yes
                modifier = {
                    factor = 2
                    years_of_peace = {
                        value > 9
                    }
                    has_country_flag = mem_broken_clock_went_to_war
                }
                modifier = {
                    factor = 5
                    years_of_peace = {
                        value > 24
                    }
                    has_country_flag = mem_broken_clock_went_to_war
                }
                modifier = {
                    factor = 10
                    years_of_peace = {
                        value > 49
                    }
                }
                modifier = {
                    factor = 1.5
                    galaxy_percentage > 0.1
                }
                modifier = {
                    factor = 2
                    galaxy_percentage > 0.2
                }
                modifier = {
                    factor = 2
                    galaxy_percentage > 0.3
                }
                modifier = {
                    factor = 10
                    galaxy_percentage > 0.5
                }
                modifier = {
                    factor = 10
                    exists = overlord
                }
                modifier = {
                    factor = 2.5
                    mid_game_years_passed > 100
                }
            }
        }
    }
}