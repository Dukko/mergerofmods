namespace = action
country_event = {
    id = action.30
    hide_window = yes
    is_triggered_only = yes
    trigger = {
        is_country_type = rebel
    }
    immediate = {
        set_country_type = default
        from.owner = {
            save_event_target_as = cc_former_owner
        }
        while = {
            count = 3
            create_leader = {
                class = scientist
                species = owner_main_species
                name = random
                skill = 1
                traits = {
                }
            }
            last_created_leader = {
                add_random_leader_trait = yes
            }
        }
        create_leader = {
            class = governor
            species = owner_main_species
            name = random
            skill = 1
            traits = {
            }
        }
        last_created_leader = {
            add_random_leader_trait = yes
        }
        create_leader = {
            class = admiral
            species = owner_main_species
            name = random
            skill = 1
            traits = {
            }
        }
        last_created_leader = {
            add_random_leader_trait = yes
        }
        create_leader = {
            class = general
            species = owner_main_species
            name = random
            skill = 1
            traits = {
            }
        }
        last_created_leader = {
            add_random_leader_trait = yes
        }
        if = {
            limit = {
                from.owner = {
                    NOT = {
                        any_owned_planet = {
                            NOT = {
                                is_same_value = from
                            }
                        }
                    }
                    NOR = {
                        is_country_type = awakened_marauders
                        is_country_type = dormant_marauders
                        is_country_type = ruined_marauders
                    }
                }
            }
            from.owner = {
                every_owned_starbase = {
                    set_owner = root
                }
            }
        }
        from.owner = {
            set_timed_relation_flag = {
                flag = ccrebel_declare_war_on
                who = ROOT
                days = 30
            }
        }
        if = {
            limit = {
                has_country_flag = slave_rebels
            }
            random_playable_country = {
                limit = {
                    reverse_has_relation_flag = {
                        flag = rebelling_slaves_former_owner
                        who = root
                    }
                }
                save_event_target_as = rsfo
            }
        }
        from = {
            solar_system = {
                every_fleet_in_system = {
                    limit = {
                        is_ship_class = shipclass_military_station
                    }
                    set_owner = root
                }
                starbase = {
                    set_owner = root
                }
            }
        }
        add_resource = {
            minerals = 1000
            energy = 1000
            alloys = 500
            consumer_goods = 500
            food = 500
            influence = 500
        }
        from.owner = {
            every_relation = {
                limit = {
                    is_rival = prev
                }
                add_opinion_modifier = {
                    who = root
                    modifier = opinion_rebelled_from_rival
                }
            }
        }
        country_event = {
            id = action.3099
        }
        if = {
            limit = {
                from.owner = {
                    OR = {
                        is_country_type = fallen_empire
                        is_country_type = awakened_fallen_empire
                        AND = {
                            is_subject = yes
                            OR = {
                                is_subject_type = protectorate
                                overlord = {
                                    OR = {
                                        is_country_type = fallen_empire
                                        is_country_type = awakened_fallen_empire
                                    }
                                }
                            }
                        }
                    }
                }
            }
            set_timed_country_flag = {
                flag = ccrebel_cut_rebellion_fleet_spawn
                days = 3600
            }
        }
    }
}