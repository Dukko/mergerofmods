namespace = crime
planet_event = {
    id = crime.40
    title = crime.40.name
    desc = {
        trigger = {
            owner = {
                NOT = {
                    has_ethic = ethic_gestalt_consciousness
                }
            }
        }
        text = crime.40.desc
    }
    desc = {
        trigger = {
            owner = {
                has_authority = auth_hive_mind
            }
        }
        text = crime.40.b.desc
    }
    desc = {
        trigger = {
            owner = {
                has_authority = auth_machine_intelligence
            }
        }
        text = crime.40.c.desc
    }
    picture = {
        trigger = {
            owner = {
                NOT = {
                    has_ethic = ethic_gestalt_consciousness
                }
            }
        }
        picture = GFX_evt_dark_alley
    }
    picture = {
        trigger = {
            owner = {
                has_authority = auth_hive_mind
            }
        }
        picture = GFX_evt_hive_mind
    }
    picture = {
        trigger = {
            owner = {
                has_authority = auth_machine_intelligence
            }
        }
        picture = GFX_evt_glitchy_matrix
    }
    show_sound = event_criminal_activity
    location = root
    pre_triggers = {
        has_owner = yes
    }
    trigger = {
        owner = {
            is_country_type = default
        }
        NOR = {
            has_planet_flag = criminal_underworld_event_up
            has_modifier = unemployment_benefits
            has_modifier = activity_program
            has_modifier = standby_mode
            has_modifier = criminal_underworld
            has_modifier = drone_deviancy
            has_modifier = drone_corruption
            has_modifier = gang_wars
            has_modifier = center_of_drug_trade
            has_modifier = mob_rule
        }
        NOT = {
            has_planet_flag = criminal_underworld_disappeared
        }
        num_pops > 0
        planet_crime >= 30
    }
    mean_time_to_happen = {
        months = 180
        modifier = {
            factor = 0.5
            planet_crime >= 50
        }
        modifier = {
            factor = 0.5
            planet_crime >= 70
        }
        modifier = {
            factor = 0.5
            planet_crime >= 90
        }
    }
    immediate = {
        set_planet_flag = criminal_underworld_event_up
        set_timed_planet_flag = {
            flag = criminal_underworld_appeared
            days = 3600
        }
        if = {
            limit = {
                owner = {
                    NOT = {
                        has_ethic = ethic_gestalt_consciousness
                    }
                }
            }
            add_modifier = {
                modifier = "criminal_underworld"
                days = -1
            }
            break = yes
        }
        if = {
            limit = {
                owner = {
                    has_authority = auth_hive_mind
                }
            }
            add_modifier = {
                modifier = "drone_deviancy"
                days = -1
            }
            break = yes
        }
        if = {
            limit = {
                owner = {
                    has_authority = auth_machine_intelligence
                }
            }
            add_modifier = {
                modifier = "drone_corruption"
                days = -1
            }
        }
    }
    after = {
        hidden_effect = {
            remove_planet_flag = criminal_underworld_event_up
        }
    }
    option = {
        name = crime.40.a
        trigger = {
            owner = {
                NOT = {
                    has_ethic = ethic_gestalt_consciousness
                }
            }
        }
        tooltip = {
            add_modifier = {
                modifier = "criminal_underworld"
                days = -1
            }
        }
    }
    option = {
        name = crime.40.b
        trigger = {
            owner = {
                has_authority = auth_hive_mind
            }
        }
        tooltip = {
            add_modifier = {
                modifier = "drone_deviancy"
                days = -1
            }
        }
    }
    option = {
        name = crime.40.c
        trigger = {
            owner = {
                has_authority = auth_machine_intelligence
            }
        }
        tooltip = {
            add_modifier = {
                modifier = "drone_corruption"
                days = -1
            }
        }
    }
}