r_shadowgate_cpc = {
    activation_duration = 3600
    portrait = "GFX_relic_shadowgate_cpc"
    sound = "shadowgate_interface_open"
    resources = {
        category = relics
        cost = {
            influence = 150
        }
    }
    ai_weight = {
        weight = 100
        modifier = {
            factor = 0
            OR = {
                NOT = {
                    any_owned_planet = {
                        is_colonized_shadowgate = yes
                    }
                }
                any_owned_planet = {
                    is_colonized_shadowgate = yes
                    check_variable_arithmetic = {
                        which = ShadowgateRP
                        subtract = ShadowgateRPMin
                        value < 100
                    }
                }
            }
        }
        modifier = {
            factor = 2
            any_owned_planet = {
                is_colonized_shadowgate = yes
                check_variable_arithmetic = {
                    which = ShadowgateRP
                    subtract = ShadowgateRPMin
                    value >= 200
                }
            }
        }
    }
    triggered_country_modifier = {
        potential = {
            always = yes
        }
        custom_tooltip = shadowgate.cpc.passive
    }
    score = 200
    active_effect = {
        custom_tooltip = shadowgate.cpc.active
        if = {
            limit = {
                NOR = {
                    is_variable_set = ShadowgateCPCStored
                    is_variable_set = ShadowgateCPCConverted
                }
            }
            custom_tooltip = shadowgate.cpc.active.static
        }
        else = {
            custom_tooltip = shadowgate.cpc.active.values
        }
        custom_tooltip = relic_triumph_cooldown
        hidden_effect = {
            country_event = {
                id = shadowgate_galactic.605
            }
            add_modifier = {
                modifier = "relic_activation_cooldown"
                days = -1
            }
        }
    }
    possible = {
        custom_tooltip = {
            fail_text = "requires_relic_no_cooldown"
            NOT = {
                has_modifier = relic_activation_cooldown
            }
        }
        custom_tooltip = {
            fail_text = "no_allied_shadowgate"
            OR = {
                AND = {
                    exists = event_target:shadowgate_ap_country
                    event_target:shadowgate_ap_country = {
                        has_communications = prev
                        NOT = {
                            is_hostile = prev
                        }
                    }
                }
                any_owned_planet = {
                    is_colonized_shadowgate = yes
                    check_variable = {
                        which = ShadowgateRP
                        value > ShadowgateRPMin
                    }
                    controller = {
                        is_same_value = prevprev
                    }
                }
                if = {
                    limit = {
                        count_federation_ally = {
                            count > 0
                        }
                    }
                    any_federation_ally = {
                        any_owned_planet = {
                            is_colonized_shadowgate = yes
                            controller = {
                                is_same_value = prevprev
                            }
                        }
                    }
                }
            }
        }
        custom_tooltip = {
            fail_text = "shadowgate.crw.fail.antiresonant.void"
            NOT = {
                has_relic = r_shadowgate_crwt_active
            }
        }
    }
}
