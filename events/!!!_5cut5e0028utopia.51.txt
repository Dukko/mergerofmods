namespace = utopia
country_event = {
    id = utopia.51
    title = "utopia.51.name"
    desc = "utopia.51.desc"
    picture = GFX_evt_think_tank
    show_sound = event_administrative_work
    location = event_target:think_tank_2
    is_triggered_only = yes
    trigger = {
        any_country = {
            is_country_type = default
            has_communications = root
            species = {
                NOR = {
                    has_trait = trait_mechanical
                    has_trait = trait_machine_unit
                }
            }
            NOR = {
                has_country_flag = fountain_of_youth
                has_country_flag = synthetic_empire
                is_same_value = root
                has_global_flag = utopia_51
            }
            any_owned_planet = {
                controller = {
                    is_same_value = prevprev
                }
            }
        }
    }
    immediate = {
        set_country_flag = think_tank_event
        set_country_flag = fountain_of_youth
        save_global_event_target_as = fountain_of_youth_country
        random_country = {
            limit = {
                is_country_type = default
                has_communications = root
                species = {
                    NOR = {
                        has_trait = trait_mechanical
                        has_trait = trait_machine_unit
                    }
                }
                NOR = {
                    has_country_flag = synthetic_empire
                    has_country_flag = fountain_of_youth
                    is_same_value = root
                    has_global_flag = utopia_51
                }
                any_owned_planet = {
                    controller = {
                        is_same_value = prevprev
                    }
                }
            }
            save_global_event_target_as = target_country
            random_owned_planet = {
                limit = {
                    controller = {
                        is_same_value = prevprev
                    }
                }
                save_global_event_target_as = missing_pops_planet
                solar_system = {
                    save_global_event_target_as = ointment_name
                }
            }
        }
    }
    option = {
        name = utopia.51.a
        trigger = {
            resource_stockpile_compare = {
                resource = energy
                value >= 1000
            }
        }
        add_resource = {
            energy = -1000
        }
        hidden_effect = {
            set_global_flag = utopia_51
        }
        hidden_effect = {
            country_event = {
                id = utopia.54
                days = 60
                random = 20
            }
        }
    }
    option = {
        name = utopia.51.b
        trigger = {
            resource_stockpile_compare = {
                resource = energy
                value >= 1000
            }
        }
        hidden_effect = {
            if = {
                limit = {
                    any_owned_leader = {
                        leader_class = scientist
                    }
                }
                country_event = {
                    id = utopia.59
                    days = 60
                    random = 20
                }
            }
            else_if = {
                limit = {
                    NOT = {
                        any_owned_leader = {
                            leader_class = scientist
                        }
                    }
                }
                country_event = {
                    id = utopia.60
                    days = 60
                    random = 20
                }
            }
        }
    }
    option = {
        name = utopia.51.c
        trigger = {
            resource_stockpile_compare = {
                resource = energy
                value < 1000
            }
        }
        hidden_effect = {
            if = {
                limit = {
                    any_owned_leader = {
                        leader_class = scientist
                    }
                }
                country_event = {
                    id = utopia.59
                    days = 60
                    random = 20
                }
            }
            else_if = {
                limit = {
                    NOT = {
                        any_owned_leader = {
                            leader_class = scientist
                        }
                    }
                }
                country_event = {
                    id = utopia.60
                    days = 60
                    random = 20
                }
            }
        }
    }
}
