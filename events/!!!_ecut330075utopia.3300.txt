namespace = utopia
country_event = {
    id = utopia.3300
    title = "utopia.3000.name"
    desc = "utopia.3300.desc"
    diplomatic = yes
    diplomatic_title = BLANK_STRING
    force_open = yes
    picture_event_data = {
        portrait = shroud1
        room = shroud_room
    }
    is_triggered_only = yes
    immediate = {
        set_country_flag = shroud_diplomacy_engaged
        if = {
            limit = {
                any_owned_leader = {
                    OR = {
                        has_trait = leader_trait_admiral_chosen
                        has_trait = leader_trait_general_chosen
                        has_trait = leader_trait_governor_chosen
                        has_trait = leader_trait_ruler_chosen
                        has_trait = leader_trait_scientist_chosen
                    }
                }
            }
            random_owned_leader = {
                limit = {
                    OR = {
                        has_trait = leader_trait_admiral_chosen
                        has_trait = leader_trait_general_chosen
                        has_trait = leader_trait_governor_chosen
                        has_trait = leader_trait_ruler_chosen
                        has_trait = leader_trait_scientist_chosen
                    }
                }
                save_event_target_as = chosen_one
            }
            set_country_flag = has_chosen_one
        }
        else = {
            random_list = {
                33 = {
                    modifier = {
                        factor = 2
                        has_relic = r_zro_crystal
                    }
                    set_country_flag = patron_deity_chance_high
                }
                33 = {
                    set_country_flag = patron_deity_chance_medium
                }
                33 = {
                    modifier = {
                        factor = 0.5
                        has_relic = r_zro_crystal
                    }
                    set_country_flag = patron_deity_chance_low
                }
            }
        }
    }
    after = {
        hidden_effect = {
            remove_country_flag = shroud_diplomacy_engaged
            remove_country_flag = patron_deity_chance_high
            remove_country_flag = patron_deity_chance_medium
            remove_country_flag = patron_deity_chance_low
        }
    }
    option = {
        name = "utopia.3300.1.a"
        custom_tooltip = "shroud.unknown.chances.high"
        trigger = {
            has_country_flag = patron_deity_chance_high
        }
        hidden_effect = {
            random_list = {
                70 = {
                    country_event = {
                        id = utopia.3303
                    }
                }
                20 = {
                    country_event = {
                        id = utopia.3302
                    }
                }
                10 = {
                    country_event = {
                        id = utopia.3301
                    }
                }
            }
        }
    }
    option = {
        name = "utopia.3300.1.b"
        custom_tooltip = "shroud.unknown.chances.medium"
        trigger = {
            has_country_flag = patron_deity_chance_medium
        }
        hidden_effect = {
            random_list = {
                50 = {
                    country_event = {
                        id = utopia.3303
                    }
                }
                30 = {
                    country_event = {
                        id = utopia.3302
                    }
                }
                20 = {
                    country_event = {
                        id = utopia.3301
                    }
                }
            }
        }
    }
    option = {
        name = "utopia.3300.1.c"
        custom_tooltip = "shroud.unknown.chances.low"
        trigger = {
            has_country_flag = patron_deity_chance_low
        }
        hidden_effect = {
            random_list = {
                30 = {
                    country_event = {
                        id = utopia.3303
                    }
                }
                40 = {
                    country_event = {
                        id = utopia.3302
                    }
                }
                30 = {
                    country_event = {
                        id = utopia.3301
                    }
                }
            }
        }
    }
    option = {
        name = "utopia.3300.1.d"
        custom_tooltip = "shroud.unknown.chances.high"
        trigger = {
            has_country_flag = has_chosen_one
        }
        hidden_effect = {
            random_list = {
                85 = {
                    country_event = {
                        id = utopia.3303
                    }
                }
                10 = {
                    country_event = {
                        id = utopia.3302
                    }
                }
                5 = {
                    country_event = {
                        id = utopia.3301
                    }
                }
            }
        }
    }
    option = {
        name = "exit.shroud"
        custom_tooltip = "exit.shroud.tooltip"
        default_hide_option = yes
    }
}
